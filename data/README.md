# ðŸ“Š data Folder

This folder contains all datasets and processed files for the Inverted Pendulum project, including collected trajectories, PID parameters, visualizations, and training pairs for both the original and FAST models.

---

## Overview

The `data` folder serves as the central storage for all raw and processed data used throughout the project. It includes:
- Raw trajectory data collected from the MuJoCo environment.
- PID parameters and initial states for each trajectory.
- Visualization images for qualitative analysis.
- Training pairs for both the original pi0 and the pi0fast models.

---

## Data Generation Details

- **Parameter Randomization:**  
  PID parameters are randomized by scaling the following base values by a factor uniformly sampled from 0.9 to 1.1:
  - `Kp1`: -3.0, `Ki1`: -0.01, `Kd1`: -0.15
  - `Kp2`: 0.08, `Ki2`: 0.05, `Kd2`: 0.001

- **Initial State:**  
  The 4-dimensional initial state is uniformly sampled within Â±0.5 for each dimension.

- **PID Output Noise:**  
  Before being applied to the simulation environment, each PID output is perturbed with uniform noise in the range of Â±0.05 N.  
  *Note: This noise is not recorded in the actions of `trajs` files, but is intended to encourage the model to learn noise robustness.*

---

## Data Quality

- All 4000 trajectories are valid and meet the stability criterion.

---

## File Structure

- **trajs/**  
  Contains the trajectory `.npy` files (shape: 100Ã—5, 4D state + 1D action per step).

- **params/**  
  Contains the PID parameters and initial state for each trajectory.

- **trajs_pics/**  
  Contains visualization images for each trajectory.

- **training_pairs_original.npz**  
  Contains 100000 training pairs, each consisting of an initial state (`state`, shape: [N, 4]) and a full action sequence (`action`, shape: [N, 50]) generated by the PID controller. This file is mainly used for training and evaluating the original pi0 model.

- **training_pairs_fast.npz**  
  Contains 100000 training pairs, each consisting of an initial state (`state`, shape: [N, 4]) and a compressed/quantized action representation (`action_chunk`, shape: [N, 25]) suitable for the pi0fast model. Actions are quantized and compressed for efficient modeling.

---

## Typical Workflow

1. **Collect Trajectories**  
   Use the scripts in the `data_collection` module to generate and save raw trajectory data, PID parameters, and visualization images.

2. **Check and Process Data**  
   Use the scripts in the `utils` module to verify data quality, build training pairs, and prepare data for model training.

3. **Train and Evaluate Models**  
   Use the processed training pairs (`training_pairs_original.npz` and `training_pairs_fast.npz`) for supervised learning and evaluation of both the original and FAST models.

---

## Notes

- All data was generated using the scripts in the `data_collection` module.
- The training pairs files were generated using the scripts in the `utils` module and are used for supervised learning of both the original and FAST models.
- Visualization images can be used for qualitative inspection of trajectory quality and controller performance.